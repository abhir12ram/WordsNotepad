<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üìò Word Notepad</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">

  <style>
    /* ------------------ OPTIMIZED CLEAN CSS ------------------ */
    body {
      font-family: 'Roboto', sans-serif;
      background-color: #F5F7FA;
      margin: 0;
      padding: 20px;
      color: #333;
      line-height: 1.6;
    }

    .container {
      max-width: 550px;
      margin: auto;
      background: #fff;
      padding: 25px;
      border-radius: 16px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
    }

    h2 {
      text-align: center;
      color: #4A90E2;
      font-size: 26px;
      margin-bottom: 20px;
      font-weight: 700;
    }

    input, textarea, button {
      width: 100%;
      padding: 12px 15px;
      margin-top: 10px;
      margin-bottom: 10px;
      border: 1px solid #DDE4E9;
      border-radius: 10px;
      font-size: 16px;
      outline: none;
      transition: all 0.3s ease;
      font-family: 'Open Sans', sans-serif;
    }

    input:focus, textarea:focus {
      border-color: #4A90E2;
      box-shadow: 0 0 0 3px rgba(74,144,226,0.2);
    }

    button {
      background-color: #4A90E2;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    button:hover {
      background-color: #357ABD;
      box-shadow: 0 4px 10px rgba(74,144,226,0.3);
      transform: translateY(-1px);
    }

    #toggleFeaturesBtn {
      background-color: #6C757D;
    }

    #toggleFeaturesBtn:hover {
      background-color: #5A6268;
    }

    .date-group {
      background: #EAF3FC;
      border: 1px solid #C4DFFB;
      border-radius: 14px;
      padding: 15px;
      margin-top: 25px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.07);
    }

    .date-header {
      font-weight: 700;
      color: #2F5F8F;
      font-size: 18px;
      margin-bottom: 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .header-btns {
      display: flex;
      gap: 8px;
    }

    .toggle-btn, .delete-btn, .select-all-btn {
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      font-size: 15px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: .3s;
    }

    .toggle-btn { background: #4A90E2; color: #fff; }
    .toggle-btn:hover { background: #357ABD; }

    .select-all-btn { background: #28A745; color: #fff; }
    .select-all-btn:hover { background: #218838; }

    .delete-btn { background: #DC3545; color: #fff; }
    .delete-btn:hover { background: #C82333; }

    .word-item {
      background: #fff;
      border: 1px solid #E0E6EB;
      border-left: 5px solid #4A90E2;
      padding: 12px 15px;
      border-radius: 12px;
      margin-top: 12px;
      display: flex;
      gap: 12px;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 3px 10px rgba(0,0,0,0.05);
      transition: .2s;
    }

    .word-item:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0,0,0,0.1);
    }

    .word-title { font-weight: 700; font-size: 17px; }
    .word-meaning { font-size: 14px; color: #666; }

    .word-container {
      overflow: hidden;
      transition: max-height .4s ease, opacity .4s ease;
    }

    .collapsed { max-height: 0 !important; opacity: 0; }

    input[type="checkbox"] {
      width: 22px;
      height: 22px;
      accent-color: #4A90E2;
    }

    .hidden { display: none; }

  </style>
</head>
<body>

  <div class="container">
    <h2>üìò Word Notepad</h2>

    <!-- Add Section -->
    <div id="add-section">
      <input type="text" id="word" placeholder="Enter new word...">
      <textarea id="meaning" placeholder="Enter meaning or notes..."></textarea>

      <label for="wordDate">üìÖ Choose Date:</label>
      <input type="date" id="wordDate">

      <button id="saveBtn">üíæ Save Word</button>
    </div>

    <button id="toggleFeaturesBtn">Show More Options ‚öôÔ∏è</button>

    <!-- Extra Features -->
    <div id="extra-features" class="hidden">
      <label for="filterDate">üìÖ Filter by Date:</label>
      <input type="date" id="filterDate">
      <button id="filterBtn">Filter</button>

      <h3>üìö All Saved Words</h3>
      <div id="wordList"></div>

      <button id="shareBtn" class="hidden">üì§ Share Selected</button>
    </div>
  </div>

<script>
/* ----------------------------- CONFIG ----------------------------- */
const API = "https://sheetdb.io/api/v1/1ttbhl00ef54o";

/* -------------------------- HELPERS ------------------------------- */
const $ = id => document.getElementById(id);

function createEl(tag, cls = "") {
  const el = document.createElement(tag);
  if (cls) el.className = cls;
  return el;
}

/* ------------------------ SAVE WORD ------------------------------ */
async function saveWord() {
  const word = $("word").value.trim();
  const meaning = $("meaning").value.trim();
  const date = $("wordDate").value;

  if (!word || !meaning) return alert("Please enter word & meaning.");

  const payload = {
    data: [{
      id: Date.now(),
      word,
      meaning,
      date
    }]
  };

  try {
    await fetch(API, {
      method: "POST",
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify(payload)
    });

    $("word").value = "";
    $("meaning").value = "";
    loadWords();
    alert("Word saved successfully!");
  } catch (err) {
    alert("Error saving word!");
  }
}

/* ------------------------ LOAD WORDS ----------------------------- */
async function loadWords(filterDate = "") {
  const list = $("wordList");
  list.innerHTML = "";

  let data = [];

  try {
    const res = await fetch(API);
    data = await res.json();
  } catch {
    return alert("Failed to load data.");
  }

  if (filterDate) data = data.filter(x => x.date === filterDate);

  const groups = {};
  data.forEach(x => {
    if (!groups[x.date]) groups[x.date] = [];
    groups[x.date].push(x);
  });

  Object.keys(groups)
    .sort((a,b) => new Date(b) - new Date(a))
    .forEach(date => renderGroup(date, groups[date]));
}

/* ------------------------ RENDER UI ------------------------------ */
function renderGroup(date, items) {
  const group = createEl("div", "date-group");

  const header = createEl("div", "date-header");
  header.innerHTML = `üìÖ ${date}`;

  const btns = createEl("div", "header-btns");

  const selectAll = createEl("button", "select-all-btn");
  selectAll.textContent = "‚úî";
  selectAll.onclick = () => toggleSelectAll(group);

  const toggle = createEl("button", "toggle-btn");
  toggle.textContent = "‚ñº";

  const container = createEl("div", "word-container");

  toggle.onclick = () => {
    const collapsed = container.classList.toggle("collapsed");
    toggle.textContent = collapsed ? "‚ñ∂" : "‚ñº";
  };

  btns.append(selectAll, toggle);
  header.append(btns);
  group.append(header);

  items.forEach(item => group.append(renderWord(item)));

  group.append(container);
  $("wordList").append(group);

  container.append(...group.querySelectorAll(".word-item"));
  container.style.maxHeight = container.scrollHeight + "px";
}

function renderWord(item) {
  const div = createEl("div", "word-item");

  const chk = document.createElement("input");
  chk.type = "checkbox";
  chk.dataset.id = item.id;

  const info = createEl("div", "word-info");
  info.innerHTML = `
    <div class="word-title">${item.word}</div>
    <div class="word-meaning">${item.meaning}</div>
  `;

  const del = createEl("button", "delete-btn");
  del.textContent = "üóë";
  del.onclick = () => deleteWord(item.id);

  div.append(chk, info, del);
  return div;
}

/* ----------------------- DELETE WORD ----------------------------- */
async function deleteWord(id) {
  if (!confirm("Delete this word?")) return;

  try {
    await fetch(`${API}/id/${id}`, {method:"DELETE"});
    loadWords();
  } catch {
    alert("Delete failed.");
  }
}

/* ----------------------- SELECT ALL ------------------------------ */
function toggleSelectAll(group) {
  const boxes = group.querySelectorAll("input[type=checkbox]");
  const allChecked = [...boxes].every(b => b.checked);
  boxes.forEach(b => b.checked = !allChecked);
}

/* ----------------------- FILTER ------------------------------ */
$("filterBtn").onclick = () => {
  loadWords($("filterDate").value);
};

/* ----------------------- SHOW/HIDE MORE ----------------------------- */
$("toggleFeaturesBtn").onclick = () => {
  $("extra-features").classList.toggle("hidden");
};

/* ------------------------ EVENTS ------------------------------ */
$("saveBtn").onclick = saveWord;

/* ------------------------ INIT ------------------------------ */
loadWords();
</script>

</body>
</html>
